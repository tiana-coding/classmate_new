<div class="px-4 py-3" [formGroup]="taskForm">
  <h3>Admin: Aufgaben verwalten</h3>

  <div *ngFor="let t of tasks" class="card mb-2 p-2">
    <div class="d-flex justify-content-between align-items-center">
      <div>
        <strong>{{ t.title }}</strong> ({{ t.class }}) - {{ t.points }}p - <small>{{ t.dueDate }}</small>
      </div>
      <div>
        <button class="btn btn-sm btn-outline-primary me-2" (click)="edit(t)">Bearbeiten</button>
        <button class="btn btn-sm btn-outline-danger" (click)="deleteTask(t.id)">Löschen</button>
      </div>
    </div>
  </div>

  <div class="mt-4">
    <h4>{{ editTask ? 'Aufgabe bearbeiten' : 'Neue Aufgabe erstellen' }}</h4>
    <div class="row g-2">
      <div class="col-md-2">
        <label for="classSelect"    class="form-label">Klasse</label>
        <select id="classSelect" formControlName="class" class="form-select">
          <option *ngFor="let c of classes" [value]="c">{{ c }}</option>
        </select>
      </div>
      <div class="col-md-4">
        <label for="titleInput"class="form-label">Titel</label>
        <input id=="titleInput" formControlName="title" type="text" class="form-control" [ngClass]="{ 'is-invalid': taskForm.get('title')?.invalid && taskForm.get('title')?.touched }"
  placeholder="Titel">
      </div>
      <div class="col-md-2">
        <label for="dueDateInput"class="form-label">Fällig</label>
        <input id= "dueDateInput" formControlName="dueDate" type="date" class="form-control"
        [ngClass]="{ 'is-invalid': taskForm.get('points')?.invalid && taskForm.get('points')?.touched }" placeholder="z. B. 2025-06-30"
        title="Wähle ein Fälligkeitsdatum aus">
      </div>
      <div class="col-md-1">
        <label class="form-label">Punkte</label>
        <input formControlName="points" type="number" class="form-control" min="0" [ngClass]="{ 'is-invalid': taskForm.get('points')?.invalid && taskForm.get('points')?.touched }" placeholder="z. B. 10">
      </div>
      <div class="col-md-3">
        <label class="form-label">PDF-Pfad</label>
        <input formControlName="documentUrl" type="text" class="form-control" placeholder="docs/Aufgaben/..."><br>
        <label class="form-label">Externer Link</label>
        <input formControlName="externalUrl" type="text" class="form-control" placeholder="https://...">
      </div>
    </div>
    <div class="mt-3">
      <button class="btn btn-success me-2" (click)="save()" [disabled]="taskForm.invalid">
        {{ editTask ? 'Aktualisieren' : 'Erstellen' }}
      </button>
      <button class="btn btn-secondary" (click)="cancel()">Abbrechen</button>
    </div>
  </div>
</div>